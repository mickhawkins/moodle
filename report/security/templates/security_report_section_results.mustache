{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template report_security/security_report_section_results

    Template for populating results of a section of the security report.

    Classes required for JS:
    * None

    Data attributes required for JS:
    * None

    Context variables required for this template:
    * issue         The name of the issue
    * link          Local link to further issue information
    * level         The risk level of the result
    * description   Description of the current risk

    Example context (json):
    {
        "sectionid": 1,
        "issues": [
            {
                "position":     "1",
                "issue":        "Password policy",
                "linkparam":    "report_security_check_passwordpolicy",
                "status":        "critical",
                "description":  "Password policy not set."
            }
        ],
        "passedcount": 1,
        "passed": [
            {
                "position":     "1",
                "issue":        "Insecure dataroot",
                "linkparam":    "report_security_check_unsecuredataroot",
                "status":       "ok",
                "statusname":   "Ok",
                "description":  "Dataroot directory must not be accessible via the web."
            }
        ]
    }
}}

<tbody data-reportsection="{{sectionid}}">
    {{#issues}}
    <tr>
        <td><a href="index.php?issue={{linkparam}}">{{issue}}</a></td>
        <td><span class="status{{status}}">{{statusname}}</span></td>
        <td>{{description}}</td>
    </tr>
    {{/issues}}
</tbody>
{{#passedcount}}
<thead>
    <tr>
    <td colspan="3">
        <span class="statusok">{{# str }} passedcheckstext, report_security, {{passedcount}} {{/ str }}</span>
        <button id="togglepassedsection{{sectionid}}" class="btn btn-link" aria-expanded="false"
                data-toggle="collapse" data-target="[data-passedsection='{{sectionid}}']">
            <span id='togglepassedsection{{sectionid}}showtext'>{{# str }} passedchecksshow, report_security {{/ str }}</span>
            <span id='togglepassedsection{{sectionid}}hidetext' class='hidden'>{{# str }} passedcheckshide, report_security {{/ str }}</span>
        </button>
    </td>
    </tr>
</thead>
<tbody data-passedsection="{{sectionid}}" class="collapse">
    {{#passed}}
    <tr>
        <td><a href="index.php?issue={{linkparam}}">{{issue}}</a></td>
        <td><span class="status{{status}}">{{statusname}}</span></td>
        <td>{{description}}</td>
    </tr>
    {{/passed}}
</tbody>
{{/passedcount}}

{{#js}}
require(['report_security/section_handlers'], function(section_handlers) {
    section_handlers.tableevents({{sectionid}});
});
{{/js}}
